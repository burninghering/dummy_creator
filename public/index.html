<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vessel Simulation</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
  <h1>Vessel Simulation</h1>
  <div id="map" style="height: 600px;"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map("map").setView([35.985, 129.56], 14);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 18,
    }).addTo(map);

    const vesselMarker = L.circleMarker([0, 0], {
      color: "blue",
      radius: 5,
    }).addTo(map);

    const polygonCoords = [
      [35.989301, 129.559683],
      [35.990568, 129.557613],
      [35.990018, 129.55592],
      [35.989333, 129.556572],
      [35.98877, 129.555796],
      [35.989203, 129.555154],
      [35.987217, 129.552773],
      [35.985626, 129.552162],
      [35.983288, 129.555102],
      [35.986041, 129.560725],
      [35.983321, 129.559852],
      [35.978506, 129.553306],
      [35.969736, 129.555431],
      [35.965728, 129.581481],
      [35.986439, 129.588861],
      [35.988819, 129.561302],
      [35.986642, 129.558267],
      [35.985553, 129.55833],
      [35.985502, 129.55761],
      [35.987199, 129.556984],
      [35.987072, 129.557047],
      [35.989301, 129.559683],
    ];
    
    L.polygon(polygonCoords, { color: "red" }).addTo(map);

    const ws = new WebSocket("ws://localhost:3001");

    ws.onmessage = (event) => {
      const data = JSON.parse(event.data);
      const latLng = [parseFloat(data.lati), parseFloat(data.longi)];
      vesselMarker.setLatLng(latLng);
      map.setView(latLng, map.getZoom());
    };
  </script>
</body>
</html>
